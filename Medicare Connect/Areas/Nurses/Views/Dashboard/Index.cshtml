@{
    ViewData["Title"] = "Nurse Dashboard";
}
@{
    // CRITICAL CHANGE: Explicitly bypass intermediate layout
    Layout = "/Views/Shared/_RoleBasedLayout.cshtml";
    ViewData["Title"] = "Consultations";
    var patients = ViewBag.Patients as IEnumerable<dynamic> ?? Enumerable.Empty<dynamic>();
    var patientKey = ViewBag.PatientKey as string;
}

@section Sidebar {
    @{
        var currentController = (ViewContext.RouteData.Values["controller"]?.ToString() ?? "").ToLowerInvariant();
    }
    <li class="nav-item">
        <a class="nav-link @(currentController == "dashboard" ? "active" : "")" asp-area="Nurses" asp-controller="Dashboard" asp-action="Index">
            <i class="bi bi-speedometer2"></i> Dashboard
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link @(currentController == "patients" ? "active" : "")" asp-area="Nurses" asp-controller="Patients" asp-action="Index">
            <i class="bi bi-people"></i> Patients
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link @(currentController == "profile" ? "active" : "")" asp-area="Nurses" asp-controller="Profile" asp-action="Index">
            <i class="bi bi-person-circle"></i> Profile
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link @(currentController == "schedule" ? "active" : "")" asp-area="Nurses" asp-controller="Schedule" asp-action="Index">
            <i class="bi bi-calendar-check"></i> Schedule
        </a>
    </li>
  
    <li class="nav-item">
        <a class="nav-link @(currentController == "prescriptions" ? "active" : "")" asp-area="Nurses" asp-controller="NursePrescriptions" asp-action="Index">
            <i class="bi bi-capsule-pill"></i> Prescriptions
        </a>
    </li>
 
   
   
}

<div class="container py-5">
    <!-- Welcome Header -->
    <div class="text-center mb-5">
        <h1 class="fw-bold display-6">Sawubona Nesi, @User.Identity?.Name 👩‍⚕️</h1>
        <p class="text-muted">Coordinate patient care, triage, and nursing notes — all in one place.</p>
    </div>

    <!-- Dashboard Grid -->
    <div class="row g-4">
        <!-- Patients -->
        <div class="col-md-4">
            <div class="card shadow-sm border-0 h-100 dashboard-card hover-card">
                <div class="card-body text-center">
                    <div class="icon-circle bg-primary bg-opacity-10 text-primary mb-3">
                        <i class="bi bi-people fs-3"></i>
                    </div>
                    <h5 class="card-title">Patients</h5>
                    <p class="text-muted small">View and manage assigned patients.</p>
                    <a class="btn btn-outline-primary w-100" asp-area="Nurses" asp-controller="Patients" asp-action="Index">
                        Go to Patients
                    </a>
                </div>
            </div>
        </div>

        <!-- Schedule -->
        <div class="col-md-4">
            <div class="card shadow-sm border-0 h-100 dashboard-card hover-card">
                <div class="card-body text-center">
                    <div class="icon-circle bg-warning bg-opacity-10 text-warning mb-3">
                        <i class="bi bi-calendar-week fs-3"></i>
                    </div>
                    <h5 class="card-title">Schedule</h5>
                    <p class="text-muted small">View your shifts and upcoming duties.</p>
                    <a class="btn btn-outline-warning w-100" asp-area="Nurses" asp-controller="Schedule" asp-action="Index">
                        Go to Schedule
                    </a>
                </div>
            </div>
        </div>

        <!-- Profile -->
        <div class="col-md-4">
            <div class="card shadow-sm border-0 h-100 dashboard-card hover-card">
                <div class="card-body text-center">
                    <div class="icon-circle bg-secondary bg-opacity-10 text-secondary mb-3">
                        <i class="bi bi-person-circle fs-3"></i>
                    </div>
                    <h5 class="card-title">Profile</h5>
                    <p class="text-muted small">Update your information and preferences.</p>
                    <a class="btn btn-outline-secondary w-100" asp-area="Nurses" asp-controller="Profile" asp-action="Index">
                        Go to Profile
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Custom Styling -->
<style>
    .dashboard-card {
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        border-radius: 1rem;
    }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
        }

    .icon-circle {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto;
    }
</style>
